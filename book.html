<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VistaKine Physics</title>

    <!-- GitHub Pages compatibility script -->
    <script>
    // Add meta info for GitHub Pages compatibility
    window.vistaKineConfig = {
        // Detect if we're on GitHub Pages
        isGitHubPages: window.location.hostname.includes('github.io'),
        // Store the repository name for path resolution - improved to handle more cases
        repoName: (function() {
            // Extract repo name from the path
            const pathParts = window.location.pathname.split('/').filter(p => p.length > 0);

            // If we're on GitHub Pages, the first path part should be the repo name
            if (window.location.hostname.includes('github.io') && pathParts.length > 0) {
                return pathParts[0];
            }

            // For local development or other scenarios, return empty string
            return '';
        })(),
        // Debug mode for development
        debug: true
    };

    // Log configuration for debugging
    if (window.vistaKineConfig.debug) {
        console.log('VistaKine Config:', window.vistaKineConfig);
    }
    </script>

    <!-- CSS Files -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/book.css">
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cannon.js/0.6.2/cannon.min.js"></script>
</head>
<body>
    <!-- Reading progress indicator -->
    <div class="reading-progress" id="reading-progress"></div>

    <!-- Navigation toggle button -->
    <button id="show-nav-toggle" class="show-nav-toggle" aria-label="Show navigation">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 256 256"><path fill="currentColor" d="M228 128a12 12 0 0 1-12 12H40a12 12 0 0 1 0-24h176a12 12 0 0 1 12 12M40 76h176a12 12 0 0 0 0-24H40a12 12 0 0 0 0 24m176 104H40a12 12 0 0 0 0 24h176a12 12 0 0 0 0-24"/></svg>
    </button>

    <!-- Main sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="ph ph-projector-screen-chart"></i>
                <h1>VistaKine</h1>
            </div>
            <div class="sidebar-actions">
                <button class="sidebar-resize-toggle" aria-label="Toggle sidebar width" title="Toggle sidebar width">
                    <span class="sidebar-resize-icon"></span>
                </button>
                <!-- Add close button for mobile -->
                <button class="sidebar-close" aria-label="Close sidebar">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 256 256"><path fill="currentColor" d="M165.66 101.66L139.31 128l26.35 26.34a8 8 0 0 1-11.32 11.32L128 139.31l-26.34 26.35a8 8 0 0 1-11.32-11.32L116.69 128l-26.35-26.34a8 8 0 0 1 11.32-11.32L128 116.69l26.34-26.35a8 8 0 0 1 11.32 11.32M232 128A104 104 0 1 1 128 24a104.11 104.11 0 0 1 104 104m-16 0a88 88 0 1 0-88 88a88.1 88.1 0 0 0 88-88"/></svg>
                </button>
            </div>
        </div>

        <div class="search-container">
            <input type="text" placeholder="Search textbook..." aria-label="Search">
            <i class="ph ph-magnifying-glass"></i>
        </div>

        <nav class="sidebar-nav">
            <a href="#cover" class="nav-chapter">
                <div class="chapter-number">0</div>
                <span>Cover Page</span>
            </a>

            <a href="#about" class="nav-chapter">
                <div class="chapter-number">0</div>
                <span>About</span>
            </a>

            <a href="#chapters" class="nav-chapter">
                <div class="chapter-number">C</div>
                <span>Chapters</span>
            </a>

            <!-- Color legend removed since it's now on the chapter page -->

            <a href="#chapter1-intro" class="nav-chapter">
                <div class="chapter-number">1</div>
                <span>Understanding 3D Space</span>
            </a>
            <div class="subchapter-list">
                <a href="#chapter1-intro" class="nav-subchapter">1.1 Introduction to 3D Coordinates</a>
                <a href="#chapter1-coordinates" class="nav-subchapter">1.2 Coordinate Systems</a>
                <a href="#chapter1-matrices" class="nav-subchapter">1.3 Matrices as Transformations</a>
                <a href="#chapter1-matrix-lab" class="nav-subchapter">1.4 Interactive Matrix Lab</a>
            </div>

            <a href="#chapter2-intro" class="nav-chapter">
                <div class="chapter-number">2</div>
                <span>Vector Fundamentals</span>
            </a>
            <div class="subchapter-list">
                <a href="#chapter2-intro" class="nav-subchapter">2.1 What are Vectors?</a>
                <a href="#chapter2-operations" class="nav-subchapter">2.2 Vector Operations</a>
                <a href="#chapter2-dot-products" class="nav-subchapter">2.3 Dot Products</a>
                <a href="#chapter2-applications" class="nav-subchapter">2.4 Applications: Force and Displacement</a>
            </div>

            <a href="#chapter3-definition" class="nav-chapter">
                <div class="chapter-number">3</div>
                <span>Cross Products and Applications</span>
            </a>
            <div class="subchapter-list">
                <a href="#chapter3-definition" class="nav-subchapter">3.1 Cross Product Definition</a>
                <a href="#chapter3-geometric" class="nav-subchapter">3.2 Geometric Interpretation</a>
                <a href="#chapter3-applications" class="nav-subchapter">3.3 Applications: Torque and Angular Momentum</a>
                <a href="#chapter3-triple" class="nav-subchapter">3.4 Triple Products and Volume</a>
            </div>
        </nav>

        <!-- Add the resize handle -->
        <div class="sidebar-resize-handle" data-tooltip="Expand sidebar">
            <div class="resize-handle-line"></div>
        </div>
    </aside>

    <!-- Main content container -->
    <main id="book-content">
        <!-- Section containers -->
        <section id="cover" class="section-container">
            <div class="section-content" data-src="sections/cover.html">
                <div class="loading-placeholder">Loading cover...</div>
            </div>
        </section>

        <section id="about" class="section-container">
            <div class="section-content" data-src="sections/about.html">
                <div class="loading-placeholder">Loading about section...</div>
            </div>
        </section>

        <section id="chapters" class="section-container">
            <div class="section-content" data-src="sections/chapters.html">
                <div class="loading-placeholder">Loading chapters...</div>
            </div>
        </section>

        <!-- Chapter 1 sections -->
        <section id="chapter1-intro" class="section-container">
            <div class="section-content" data-src="sections/chapter1-intro.html">
                <div class="loading-placeholder">Loading section 1.1...</div>
            </div>
        </section>

        <section id="chapter1-coordinates" class="section-container">
            <div class="section-content" data-src="sections/chapter1-coordinates.html">
                <div class="loading-placeholder">Loading section 1.2...</div>
            </div>
        </section>

        <section id="chapter1-matrices" class="section-container">
            <div class="section-content" data-src="sections/chapter1-matrices.html">
                <div class="loading-placeholder">Loading section 1.3...</div>
            </div>
        </section>

        <section id="chapter1-matrix-lab" class="section-container">
            <div class="section-content" data-src="sections/chapter1-matrix-lab.html">
                <div class="loading-placeholder">Loading section 1.4...</div>
            </div>
        </section>

        <!-- Chapter 2 sections -->
        <section id="chapter2-intro" class="section-container">
            <div class="section-content" data-src="sections/chapter2-intro.html">
                <div class="loading-placeholder">Loading section 2.1...</div>
            </div>
        </section>

        <section id="chapter2-operations" class="section-container">
            <div class="section-content" data-src="sections/chapter2-operations.html">
                <div class="loading-placeholder">Loading section 2.2...</div>
            </div>
        </section>

        <section id="chapter2-dot-products" class="section-container">
            <div class="section-content" data-src="sections/chapter2-dot-products.html">
                <div class="loading-placeholder">Loading section 2.3...</div>
            </div>
        </section>

        <section id="chapter2-applications" class="section-container">
            <div class="section-content" data-src="sections/chapter2-applications.html">
                <div class="loading-placeholder">Loading section 2.4...</div>
            </div>
        </section>

        <!-- Chapter 3 sections -->
        <section id="chapter3-definition" class="section-container">
            <div class="section-content" data-src="sections/chapter3-definition.html">
                <div class="loading-placeholder">Loading section 3.1...</div>
            </div>
        </section>

        <section id="chapter3-geometric" class="section-container">
            <div class="section-content" data-src="sections/chapter3-geometric.html">
                <div class="loading-placeholder">Loading section 3.2...</div>
            </div>
        </section>

        <section id="chapter3-applications" class="section-container">
            <div class="section-content" data-src="sections/chapter3-applications.html">
                <div class="loading-placeholder">Loading section 3.3...</div>
            </div>
        </section>

        <section id="chapter3-triple" class="section-container">
            <div class="section-content" data-src="sections/chapter3-triple.html">
                <div class="loading-placeholder">Loading section 3.4...</div>
            </div>
        </section>
    </main>

    <!-- Minimal Bottom Navigation -->
    <div class="bottom-nav-trigger"></div>
    <div class="bottom-nav">
        <button class="bottom-nav-button prev-nav" aria-label="Previous Section">
            <i class="ph ph-caret-left"></i> Previous
        </button>
        <div class="bottom-nav-section">
            <span class="current-section-name">Current Section</span>
        </div>
        <button class="bottom-nav-button next-nav" aria-label="Next Section">
            Next <i class="ph ph-caret-right"></i>
        </button>
    </div>

    <script src="js/sidebar-resize.js"></script>
    <script src="js/book-loader.js"></script>
    <script src="js/visualization-engine.js"></script>

    <!-- Page navigation script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Immediately initialize the mobile navigation
            initializeMobileNavigation();

            // Get all section links
            const sectionLinks = document.querySelectorAll('.nav-chapter, .nav-subchapter');

            // Add page numbers to sidebar navigation
            sectionLinks.forEach((link, index) => {
                // Skip the cover, about, and chapters pages
                if (index > 2) {
                    const pageNum = document.createElement('span');
                    pageNum.className = 'page-num';

                    // Create icon element
                    const icon = document.createElement('i');
                    icon.className = 'ph ph-hash';

                    // Add icon and number to the page number element
                    pageNum.appendChild(icon);
                    pageNum.appendChild(document.createTextNode(index - 2)); // Add the number after the icon

                    link.appendChild(pageNum);
                }
            });

            // Setup bottom navigation
            const prevNavBtn = document.querySelector('.prev-nav');
            const nextNavBtn = document.querySelector('.next-nav');
            const currentSectionSpan = document.querySelector('.current-section-name');

            // Update the current section name based on active section
            function updateCurrentSection() {
                const activeSection = document.querySelector('.nav-chapter.active, .nav-subchapter.active');
                if (activeSection) {
                    currentSectionSpan.textContent = activeSection.textContent.trim().replace(/\d+$/, '');
                }
            }

            // Handle navigation button clicks
            prevNavBtn.addEventListener('click', function() {
                const activeLink = document.querySelector('.nav-chapter.active, .nav-subchapter.active');
                if (activeLink) {
                    const allLinks = Array.from(sectionLinks);
                    const currentIndex = allLinks.indexOf(activeLink);
                    if (currentIndex > 0) {
                        const prevLink = allLinks[currentIndex - 1];
                        if (prevLink && prevLink.getAttribute('href')) {
                            window.location.hash = prevLink.getAttribute('href').replace('#', '');
                        }
                    }
                }
            });

            nextNavBtn.addEventListener('click', function() {
                const activeLink = document.querySelector('.nav-chapter.active, .nav-subchapter.active');
                if (activeLink) {
                    const allLinks = Array.from(sectionLinks);
                    const currentIndex = allLinks.indexOf(activeLink);
                    if (currentIndex < allLinks.length - 1) {
                        const nextLink = allLinks[currentIndex + 1];
                        if (nextLink && nextLink.getAttribute('href')) {
                            window.location.hash = nextLink.getAttribute('href').replace('#', '');
                        }
                    }
                }
            });

            // Call this initially and whenever the hash changes
            updateCurrentSection();
            window.addEventListener('hashchange', updateCurrentSection);

            // Calculate reading time when content is loaded
            function calculateReadingTime(content) {
                // Average reading speed (words per minute)
                const wordsPerMinute = 200;

                // Count words in the content (rough estimate)
                const text = content.textContent || content.innerText;
                const wordCount = text.trim().split(/\s+/).length;

                // Calculate reading time in minutes
                const readingTime = Math.ceil(wordCount / wordsPerMinute);

                return readingTime < 1 ? '< 1 min read' : readingTime + ' min read';
            }

            // Update reading time for each section when loaded
            function updateReadingTime(sectionContent) {
                const readingTimeElement = sectionContent.querySelector('.reading-time span');
                if (readingTimeElement && sectionContent) {
                    const textContent = sectionContent.querySelector('.section-text');
                    if (textContent) {
                        readingTimeElement.textContent = calculateReadingTime(textContent);
                    }
                }
            }

            // When section content is loaded, calculate reading time
            // This would be integrated with your existing content loading system
            document.addEventListener('section-loaded', function(e) {
                if (e.detail && e.detail.sectionElement) {
                    updateReadingTime(e.detail.sectionElement);
                }
            });

            // For demonstration/testing - manually update any existing reading times
            document.querySelectorAll('.section-inner').forEach(section => {
                updateReadingTime(section);
            });

            // URL Parameter Handler to reset sidebar state if needed
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('reset_sidebar')) {
                console.log('Resetting sidebar state based on URL parameter');
                localStorage.removeItem('sidebarWidth');
                // Redirect to the same page without the parameter
                const newUrl = window.location.pathname + window.location.hash;
                window.history.replaceState({}, document.title, newUrl);
            }

            // MOBILE NAVIGATION DEBUGGING HELPER
            // Create a small debug panel that can be toggled on/off
            const debugHelper = document.createElement('div');
            debugHelper.style.position = 'fixed';
            debugHelper.style.bottom = '10px';
            debugHelper.style.right = '10px';
            debugHelper.style.backgroundColor = 'rgba(0,0,0,0.7)';
            debugHelper.style.color = 'white';
            debugHelper.style.padding = '8px';
            debugHelper.style.fontSize = '10px';
            debugHelper.style.zIndex = '9999';
            debugHelper.style.display = 'none';
            debugHelper.id = 'mobile-debug';
            document.body.appendChild(debugHelper);

            // Toggle debug panel with triple tap on bottom right corner
            let tapCount = 0;
            document.addEventListener('touchend', function(e) {
                const x = e.changedTouches[0].clientX;
                const y = e.changedTouches[0].clientY;
                const screenW = window.innerWidth;
                const screenH = window.innerHeight;

                if (x > screenW - 50 && y > screenH - 50) {
                    tapCount++;
                    if (tapCount === 3) {
                        debugHelper.style.display = debugHelper.style.display === 'none' ? 'block' : 'none';
                        tapCount = 0;
                    }

                    setTimeout(() => {
                        if (tapCount > 0) tapCount--;
                    }, 1000);
                }
            });

            // Log important events to the debug panel
            function logDebug(msg) {
                const time = new Date().toTimeString().split(' ')[0];
                debugHelper.innerHTML += `<div>[${time}] ${msg}</div>`;
                debugHelper.scrollTop = debugHelper.scrollHeight;
                console.log(`[DEBUG] ${msg}`);

                // Keep only the last 10 messages
                const messages = debugHelper.querySelectorAll('div');
                if (messages.length > 10) {
                    for (let i = 0; i < messages.length - 10; i++) {
                        messages[i].remove();
                    }
                }
            }

            // Force enable mobile navigation
            function forceMobileNav() {
                // This is our last resort option if nothing else works
                logDebug("Forcing mobile navigation");

                // Get elements
                const navToggle = document.getElementById('show-nav-toggle');
                const sidebar = document.querySelector('.sidebar');

                if (!navToggle || !sidebar) {
                    logDebug("ERROR: Critical elements missing");
                    return;
                }

                // Force override any handlers on the button
                navToggle.onclick = null;
                navToggle.ontouchend = null;

                // Reapply onclick directly with more robust handling
                navToggle.onclick = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log("FAB clicked - direct handler");
                    sidebar.classList.add('active');
                    navToggle.style.display = 'none';
                    logDebug("Sidebar opened via force handler");
                    return false; // Prevent any default behavior
                };

                // Make button highly visible in debug mode
                if (debugHelper.style.display !== 'none') {
                    navToggle.style.boxShadow = '0 0 0 3px red';
                }
            }

            // Initialize mobile navigation with enhanced touch support
            function initializeMobileNavigation() {
                console.log("Initializing mobile navigation...");

                const sidebar = document.querySelector('.sidebar');
                const showNavToggle = document.getElementById('show-nav-toggle');
                const sidebarClose = document.querySelector('.sidebar-close');

                // Log state for debugging
                if (showNavToggle) {
                    console.log("✅ Navigation toggle button found");
                    // Make it very visible for testing
                    showNavToggle.style.opacity = "1";
                    showNavToggle.style.display = "flex";
                    showNavToggle.removeAttribute('aria-hidden');
                } else {
                    console.error("❌ Navigation toggle button not found!");
                }

                if (sidebar) {
                    console.log("✅ Sidebar element found");
                    // Check if sidebar is already active and update FAB visibility accordingly
                    if (sidebar.classList.contains('active')) {
                        console.log("Sidebar is already active, hiding FAB");
                        if (showNavToggle) {
                            showNavToggle.style.display = 'none';
                            showNavToggle.style.opacity = '0';
                            showNavToggle.setAttribute('aria-hidden', 'true');
                        }
                    }
                } else {
                    console.error("❌ Sidebar element not found!");
                }

                if (sidebarClose) {
                    console.log("✅ Sidebar close button found");
                } else {
                    console.error("❌ Sidebar close button not found!");
                }

                // Add a direct click handler to the FAB
                if (showNavToggle) {
                    console.log("Adding click handlers to navigation toggle");

                    // First remove any existing handlers
                    showNavToggle.removeAttribute('onclick');
                    const newClickHandler = function(e) {
                        if (e) {
                            e.preventDefault();
                            e.stopPropagation();
                        }
                        console.log("🔳 Navigation toggle clicked!");
                        if (sidebar) {
                            sidebar.classList.add('active');
                            // Force hide FAB with both display and opacity
                            showNavToggle.style.display = 'none';
                            showNavToggle.style.opacity = '0';
                            showNavToggle.setAttribute('aria-hidden', 'true');
                            console.log("🔳 Sidebar opened, FAB hidden");
                        }
                    };

                    // Apply the handlers multiple ways for maximum compatibility
                    showNavToggle.onclick = newClickHandler;
                    showNavToggle.addEventListener('click', newClickHandler);
                    showNavToggle.addEventListener('touchend', newClickHandler);
                }

                // Add a direct click handler to the close button
                if (sidebarClose) {
                    console.log("Adding click handlers to sidebar close button");

                    const closeHandler = function(e) {
                        if (e) {
                            e.preventDefault();
                            e.stopPropagation();
                        }
                        console.log("🔳 Close button clicked!");
                        if (sidebar) {
                            sidebar.classList.remove('active');
                            if (showNavToggle) {
                                // Force show FAB with both display and opacity using a slight delay
                                // to ensure transitions complete first
                                setTimeout(function() {
                                    showNavToggle.style.display = 'flex';
                                    showNavToggle.style.opacity = '1';
                                    showNavToggle.removeAttribute('aria-hidden');
                                    console.log("🔳 FAB visibility restored with delay");
                                }, 50);
                            }
                            console.log("🔳 Sidebar closed");
                        }
                    };

                    sidebarClose.onclick = closeHandler;
                    sidebarClose.addEventListener('click', closeHandler);
                    sidebarClose.addEventListener('touchend', closeHandler);
                }

                // Reset any styles that might be interfering
                if (sidebar) {
                    sidebar.style.transform = 'none';
                }

                // Make menu button more obviously clickable
                if (showNavToggle) {
                    showNavToggle.style.cursor = 'pointer';
                    showNavToggle.setAttribute('role', 'button');
                    showNavToggle.setAttribute('tabindex', '0');
                }

                // Close sidebar when clicking outside (but not when clicking the toggle)
                document.addEventListener('click', function(event) {
                    if (sidebar && sidebar.classList.contains('active') &&
                        !sidebar.contains(event.target) &&
                        event.target !== showNavToggle &&
                        !showNavToggle.contains(event.target)) {
                        sidebar.classList.remove('active');
                        if (showNavToggle) {
                            // Force show FAB with both display and opacity after a slight delay
                            setTimeout(function() {
                                showNavToggle.style.display = 'flex';
                                showNavToggle.style.opacity = '1';
                                showNavToggle.removeAttribute('aria-hidden');
                                console.log("🔳 FAB visibility restored after outside click");
                            }, 50);
                        }
                        console.log("🔳 Sidebar closed by clicking outside");
                    }
                });

                // Call our force function after a delay to ensure everything is loaded
                setTimeout(function() {
                    forceMobileNav();
                    // Double check visibility of the menu button
                    if (showNavToggle) {
                        showNavToggle.style.display = 'flex';
                    }
                }, 1000);

                console.log("Mobile navigation initialization complete");
            }

            // Check if we're on a mobile device (for proper behavior)
            function isMobileDevice() {
                return (window.innerWidth <= 480) ||
                       /Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            }

            // Check if we're on a tablet device
            function isTabletDevice() {
                return (window.innerWidth > 480 && window.innerWidth <= 768) ||
                       /iPad/i.test(navigator.userAgent);
            }

            // Apply mobile styles if needed
            function checkMobileView() {
                const sidebar = document.querySelector('.sidebar');
                const mainContent = document.getElementById('book-content');

                if (isMobileDevice() || isTabletDevice()) {
                    // Disable progressive sidebar for mobile and tablet
                    if (sidebar) {
                        sidebar.classList.remove('mini-collapsed');
                        sidebar.classList.remove('collapsed');

                        // Ensure main content is properly positioned
                        if (mainContent && isMobileDevice()) {
                            // Only for phones, not tablets
                            mainContent.style.marginLeft = '0';
                        }
                    }
                }
            }

            // Check on load and resize
            checkMobileView();
            window.addEventListener('resize', checkMobileView);
        });
    </script>

    <!-- JavaScript Files -->
    <script>
        // Initialize reading progress indicator
        const progressBar = document.getElementById('reading-progress');
        window.addEventListener('scroll', () => {
            const scrollPosition = window.scrollY;
            const windowHeight = window.innerHeight;
            const documentHeight = document.documentElement.scrollHeight - windowHeight;
            const progress = (scrollPosition / documentHeight) * 100;
            progressBar.style.width = `${progress}%`;
        });

        // Better mobile FAB behavior
        document.addEventListener('DOMContentLoaded', function() {
            const fab = document.querySelector('.show-nav-toggle');

            // Hide FAB when scrolling down, show when scrolling up
            let lastScrollTop = 0;
            let fabVisible = true;

            window.addEventListener('scroll', function() {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

                // Only apply this behavior on mobile
                if (window.innerWidth <= 768) {
                    // Determine scroll direction
                    if (scrollTop > lastScrollTop && scrollTop > 200) {
                        // Scrolling down and not at the top
                        if (fabVisible) {
                            fab.style.transform = 'translateY(-100px)';
                            fabVisible = false;
                        }
                    } else {
                        // Scrolling up or at top
                        if (!fabVisible) {
                            fab.style.transform = 'translateY(0)';
                            fabVisible = true;
                        }
                    }

                    lastScrollTop = scrollTop;
                }
            });

            // Make sure the FAB is visible when at the top or bottom of the page
            window.addEventListener('scrollend', function() {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                const scrollHeight = document.documentElement.scrollHeight;
                const windowHeight = window.innerHeight;

                // Show FAB when at top or bottom of page
                if (scrollTop < 100 || (scrollTop + windowHeight >= scrollHeight - 100)) {
                    fab.style.transform = 'translateY(0)';
                    fabVisible = true;
                }
            });
        });
    </script>
</body>
</html>
